import{C as m,r as y,u as n,x as l,z as p}from"./chunk-JOGVLLNH.js";import{Ea as T,i as u,o as d,r as h}from"./chunk-SPIVRC24.js";import{g as r}from"./chunk-PM2M367S.js";var C=class g{constructor(s,t){this._http=s;this._firestore=t;this.getTasksDatabase()}getCategoriesDatabase(){return r(this,null,function*(){let t=this._http.get("./CategoriesDB/default-database.json");return(yield u(t)).categories})}getTasksDatabase(){return r(this,null,function*(){let t=this._http.get("./CategoriesDB/default-database.json");return(yield u(t)).tasks})}getTask(s,t){return r(this,null,function*(){try{let o=(yield this.getTasksDatabase()).find(c=>c.uuid===s);if(o)return o;let i=n(this._firestore,"Familly",t,"UserDatabase"),e=p(i,m("uuid","==",s)),f=yield l(e);if(!f.empty)return f.docs[0].data();throw new Error("Task not found in both local database and Firestore")}catch(a){throw console.error("Error fetching task:",a),new Error("Failed to fetch task.")}})}getAllCategories(s){return r(this,null,function*(){try{let t=yield this.getCategoriesDatabase(),a=n(this._firestore,"Familly",s,"Categories"),i=(yield l(a)).docs.map(e=>e.data()).filter(e=>"title"in e&&"uuid"in e);return[...t,...i]}catch(t){throw console.error("Error fetching all categories:",t),new Error("Failed to fetch categories.")}})}getAllTasksByCategory(s,t){return r(this,null,function*(){try{let o=(yield this.getTasksDatabase()).filter(k=>k.categoryUuid===s),i=n(this._firestore,"Familly",t,"UserDatabase"),e=p(i,m("categoryUuid","==",s)),c=(yield l(e)).docs.map(k=>k.data());return[...o,...c]}catch(a){throw console.error("Error fetching tasks by category:",a),new Error("Failed to fetch tasks.")}})}static \u0275fac=function(t){return new(t||g)(h(T),h(y))};static \u0275prov=d({token:g,factory:g.\u0275fac,providedIn:"root"})};export{C as a};
