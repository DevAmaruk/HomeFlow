import{a as v}from"./chunk-WVY745H3.js";import{C as w,D as g,r as p,t as h,u as i,x as c,z as k}from"./chunk-JOGVLLNH.js";import{o as y,r as l}from"./chunk-SPIVRC24.js";import{a as f,b as u,g as o}from"./chunk-PM2M367S.js";var F=class s{constructor(a,t){this._firestore=a;this._famillyService=t}addTask(a){return o(this,null,function*(){try{let t=yield this._famillyService.getFamillyGroupName();if(!t)throw new Error("Familly group name is not set. Please set it before adding tasks.");let e=i(this._firestore,"Familly",t,"Tasks");yield h(e,a),console.log(`Task added successfully: ${JSON.stringify(a)}`)}catch(t){throw console.error("Error adding task:",t),new Error("Failed to add task. Please try again later.")}})}validateTask(a){return o(this,null,function*(){try{let t=!a.validated,e=yield this._famillyService.getFamillyGroupName();if(!e)throw new Error("Familly group name is not set.");let n=i(this._firestore,"Familly",e,"Tasks"),r=k(n,w("uuid","==",a.uuid)),m=yield c(r);if(m.empty){console.warn("No task found with the given UUID:",a.uuid);return}let d=g(this._firestore);m.docs.forEach(T=>{d.update(T.ref,{validated:t})}),yield d.commit(),console.log(`Task validation status updated successfully for UUID: ${a.uuid}`)}catch(t){throw console.error("Error validating task:",t),new Error("Failed to validate task. Please try again later.")}})}getTasksFromFamillyGroup(){return o(this,null,function*(){try{let a=yield this._famillyService.getFamillyGroupName();if(!a)throw new Error("Familly group name is not set. Please set it before getting tasks.");let t=i(this._firestore,"Familly",a,"Tasks");return(yield c(t)).docs.map(r=>u(f({},r.data()),{dueDate:r.get("dueDate")||null}))}catch(a){throw console.error("Error fetching tasks:",a),new Error("Failed to fetch tasks. Please try again later.")}})}static \u0275fac=function(t){return new(t||s)(l(p),l(v))};static \u0275prov=y({token:s,factory:s.\u0275fac,providedIn:"root"})};export{F as a};
