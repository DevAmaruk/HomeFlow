import{a as q}from"./chunk-ZKLHUJ5Z.js";import{a as V}from"./chunk-QUF2MSQX.js";import{a as L}from"./chunk-QFI5ZUMR.js";import{A as B,r as R,t as w,u as C,v as j,x as G}from"./chunk-JEBJIWP7.js";import{P as m,Q as f,Qa as S,S as b,W as v,Wa as F,_ as k,ca as o,da as r,eb as M,ib as D,ja as T,lb as E,pb as U,rb as P,ta as l,u as h,ub as N,va as _,vb as I,wa as d,wb as O,x as u,xa as g,xb as W,ya as p,yb as A}from"./chunk-TPGHJTJC.js";import{g as s}from"./chunk-PM2M367S.js";var y=class n{constructor(t,e,a,c){this._firestore=t;this._authService=e;this._famillyService=a;this._databaseService=c;this.userObs=this._authService.user$}userObs;user=null;addDefaultCustomTask(t){return s(this,null,function*(){let e=j(t);yield B(e,{createdAt:new Date})})}addCustomTaskToUserDatabase(t){return s(this,null,function*(){try{let e=yield this._famillyService.getFamillyGroupName();if(!e)throw new Error("Familly group name is not set. Please set it before adding tasks.");let a=C(this._firestore,"Familly",e,"UserDatabase");yield w(a,t)}catch(e){throw console.error("Error adding custom task to user database:",e),new Error("Failed to add custom task. Please try again later.")}})}addCustomCategoryToDatabase(t){return s(this,null,function*(){try{let e=yield this._famillyService.getFamillyGroupName();if(!e)throw new Error("Familly group name is not set. Please set it before adding tasks.");let a=C(this._firestore,"Familly",e,"Categories");yield w(a,t),console.log("Category added successfully:",t)}catch(e){throw console.error("Error adding category to database:",e),new Error("Failed to add category. Please try again later.")}})}getAllCategories(){return s(this,null,function*(){try{let t=yield this._famillyService.getFamillyGroupName();if(!t)throw new Error("Familly group name is not set. Please set it before adding tasks.");let e=C(this._firestore,"Familly",t,"Categories"),c=(yield G(e)).docs.map(H=>H.data());return[...yield this._databaseService.getCategoriesDatabase(),...c]}catch(t){throw console.error("Error getting categories:",t),new Error("Failed to get categories. Please try again later.")}})}static \u0275fac=function(e){return new(e||n)(u(R),u(L),u(V),u(q))};static \u0275prov=h({token:n,factory:n.\u0275fac,providedIn:"root"})};function Q(n,t){if(n&1&&(o(0,"option",10),l(1),r()),n&2){let e=t.$implicit;k("value",e.uuid),m(),_(" ",e.title," ")}}var z=class n{constructor(t,e){this._customTaskCreationService=t;this._router=e}newTask={description:"",icon:"",score:0,categoryUuid:""};newCategory={title:"",icon:""};categories=[];ngOnInit(){return s(this,null,function*(){yield this.loadCategories()})}loadCategories(){return s(this,null,function*(){try{this.categories=yield this._customTaskCreationService.getAllCategories(),console.log("Fetched categories:",this.categories)}catch(t){console.error("Error fetching categories:",t)}})}addCustomCategory(){return s(this,null,function*(){if(!this.newCategory.title){alert("Please enter a category title.");return}let t={uuid:crypto.randomUUID(),title:this.newCategory.title,icon:this.newCategory.icon||""};yield this._customTaskCreationService.addCustomCategoryToDatabase(t),alert("Category created successfully!"),this.resetFormCat()})}resetFormCat(){this.newCategory={title:"",icon:""}}addCustomTask(){return s(this,null,function*(){if(!this.newTask.description){alert("Please enter a task description.");return}if(!this.newTask.categoryUuid){alert("Please select a category.");return}let t={uuid:crypto.randomUUID(),icon:this.newTask.icon||"",description:this.newTask.description||"",score:this.newTask.score||0,dueDate:"",frequency:"",assignee:"",validated:!1,categoryUuid:this.newTask.categoryUuid||""};yield this._customTaskCreationService.addCustomTaskToUserDatabase(t),alert("Task created successfully!"),this.resetForm()})}resetForm(){this.newTask={description:"",icon:"",score:0,categoryUuid:""}}backToCat(){this._router.navigate(["/category"])}static \u0275fac=function(e){return new(e||n)(f(y),f(M))};static \u0275cmp=b({type:n,selectors:[["app-custom-task-creation"]],decls:20,vars:5,consts:[["for","category"],["id","category",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","description"],["id","description","type","text",3,"ngModelChange","ngModel"],["for","icon"],["id","icon","type","text",3,"ngModelChange","ngModel"],["for","score"],["id","score","type","number",3,"ngModelChange","ngModel"],[3,"click"],[3,"value"]],template:function(e,a){e&1&&(o(0,"div")(1,"label",0),l(2,"Select Category:"),r(),o(3,"select",1),p("ngModelChange",function(i){return g(a.newTask.categoryUuid,i)||(a.newTask.categoryUuid=i),i}),v(4,Q,2,2,"option",2),r()(),o(5,"div")(6,"label",3),l(7,"Task Description:"),r(),o(8,"input",4),p("ngModelChange",function(i){return g(a.newTask.description,i)||(a.newTask.description=i),i}),r(),o(9,"label",5),l(10,"Task Icon:"),r(),o(11,"input",6),p("ngModelChange",function(i){return g(a.newTask.icon,i)||(a.newTask.icon=i),i}),r(),o(12,"label",7),l(13,"Task Score:"),r(),o(14,"input",8),p("ngModelChange",function(i){return g(a.newTask.score,i)||(a.newTask.score=i),i}),r(),o(15,"button",9),T("click",function(){return a.addCustomTask()}),l(16,"Create Task"),r()(),o(17,"div")(18,"button",9),T("click",function(){return a.backToCat()}),l(19,"Go to Categories"),r()()),e&2&&(m(3),d("ngModel",a.newTask.categoryUuid),m(),k("ngForOf",a.categories),m(4),d("ngModel",a.newTask.description),m(3),d("ngModel",a.newTask.icon),m(3),d("ngModel",a.newTask.score))},dependencies:[W,I,O,D,P,N,E,U,F,S,A],encapsulation:2})};export{z as CustomTaskCreationComponent};
