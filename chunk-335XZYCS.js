import{a as Y}from"./chunk-UJ3AH5BS.js";import{a as Q}from"./chunk-NYWG3EHS.js";import{a as K}from"./chunk-GQQAA7PF.js";import{A as J,r as V,t as w,u as p,v as X,x as H}from"./chunk-XZMDPNNJ.js";import{$a as O,Ba as F,Bb as q,G as c,H as C,Ha as E,I as T,La as D,P as b,Pa as M,Q as v,R as r,S as n,T as S,Ta as x,Ua as P,Za as U,_,ab as R,bb as N,cb as j,ea as l,fa as I,ha as f,hb as G,ia as y,ja as h,jb as L,kb as A,lb as W,o as k,ob as z,r as d,sb as B}from"./chunk-SPIVRC24.js";import"./chunk-SRKNPOHE.js";import"./chunk-7KGURMOZ.js";import"./chunk-BLW5R4XS.js";import"./chunk-XPWJSSAW.js";import"./chunk-WNRD3PDI.js";import"./chunk-QQJWOYZO.js";import"./chunk-MHO3CSUV.js";import"./chunk-4WFVMWDK.js";import"./chunk-XDPEVTHG.js";import"./chunk-NMYJD6OP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-7D2EH4XU.js";import"./chunk-MMIXVVWR.js";import"./chunk-SV7S5NYR.js";import{g as a}from"./chunk-PM2M367S.js";var g=class o{constructor(e,t,i,m){this._firestore=e;this._authService=t;this._famillyService=i;this._databaseService=m;this.userObs=this._authService.user$}userObs;user=null;addDefaultCustomTask(e){return a(this,null,function*(){let t=X(e);yield J(t,{createdAt:new Date})})}addCustomTaskToUserDatabase(e){return a(this,null,function*(){try{let t=yield this._famillyService.getFamillyGroupName();if(!t)throw new Error("Familly group name is not set. Please set it before adding tasks.");let i=p(this._firestore,"Familly",t,"UserDatabase");yield w(i,e)}catch(t){throw console.error("Error adding custom task to user database:",t),new Error("Failed to add custom task. Please try again later.")}})}addCustomCategoryToDatabase(e){return a(this,null,function*(){try{let t=yield this._famillyService.getFamillyGroupName();if(!t)throw new Error("Familly group name is not set. Please set it before adding tasks.");let i=p(this._firestore,"Familly",t,"Categories");yield w(i,e),console.log("Category added successfully:",e)}catch(t){throw console.error("Error adding category to database:",t),new Error("Failed to add category. Please try again later.")}})}getAllCategories(){return a(this,null,function*(){try{let e=yield this._famillyService.getFamillyGroupName();if(!e)throw new Error("Familly group name is not set. Please set it before adding tasks.");let t=p(this._firestore,"Familly",e,"Categories"),m=(yield H(t)).docs.map(u=>u.data()).filter(u=>"title"in u&&"uuid"in u);return[...yield this._databaseService.getCategoriesDatabase(),...m]}catch(e){throw console.error("Error getting categories:",e),new Error("Failed to get categories. Please try again later.")}})}static \u0275fac=function(t){return new(t||o)(d(V),d(K),d(Q),d(Y))};static \u0275prov=k({token:o,factory:o.\u0275fac,providedIn:"root"})};var te=(o,e)=>e.uuid;function ie(o,e){if(o&1&&(r(0,"ion-col",4)(1,"div",5)(2,"ion-card")(3,"ion-card-content",6)(4,"ion-list",7),S(5,"ion-img",8),r(6,"ion-text",9),l(7),n()()()()()()),o&2){let t=e.$implicit;c(5),_("src",t.icon),c(2),I(t.title)}}var Z=class o{constructor(e,t){this._customTaskCreationService=e;this._router=t}newTask={description:"",icon:"",score:0,categoryUuid:""};newCategory={title:"",icon:""};categories=[];ngOnInit(){return a(this,null,function*(){yield this.loadCategories()})}loadCategories(){return a(this,null,function*(){try{this.categories=yield this._customTaskCreationService.getAllCategories(),console.log("Fetched categories:",this.categories)}catch(e){console.error("Error fetching categories:",e)}})}addCustomCategory(){return a(this,null,function*(){if(!this.newCategory.title){alert("Please enter a category title.");return}let e={uuid:crypto.randomUUID(),title:this.newCategory.title,icon:this.newCategory.icon||""};yield this._customTaskCreationService.addCustomCategoryToDatabase(e),alert("Category created successfully!"),this.resetFormCat()})}resetFormCat(){this.newCategory={title:"",icon:""}}addCustomTask(){return a(this,null,function*(){if(!this.newTask.description){alert("Please enter a task description.");return}if(!this.newTask.categoryUuid){alert("Please select a category.");return}let e={uuid:crypto.randomUUID(),icon:this.newTask.icon||"",description:this.newTask.description||"",score:this.newTask.score||0,dueDate:"",frequency:"",assignee:"",validated:!1,categoryUuid:this.newTask.categoryUuid||""};yield this._customTaskCreationService.addCustomTaskToUserDatabase(e),alert("Task created successfully!"),this.resetForm()})}resetForm(){this.newTask={description:"",icon:"",score:0,categoryUuid:""}}backToCat(){this._router.navigate(["/category"])}static \u0275fac=function(t){return new(t||o)(C(g),C(E))};static \u0275cmp=T({type:o,selectors:[["app-custom-task-creation"]],decls:28,vars:2,consts:[[1,"ion-padding"],[1,"taskDescriptionContainer"],["id","description","type","text",1,"input","ion-padding",3,"ngModelChange","ngModel"],["id","score","type","number",1,"input","ion-padding",3,"ngModelChange","ngModel"],["sizeXs","6","sizeSm","6","sizeMd","6","sizeLg","3"],[1,"catCardContainer"],[1,"catCard"],[1,"catCardList"],[1,"catIcon",3,"src"],[1,"catTitle"]],template:function(t,i){t&1&&(r(0,"ion-content",0)(1,"div",1)(2,"ion-grid",0)(3,"ion-row")(4,"ion-col")(5,"ion-label"),l(6,"Description de la t\xE2che"),n()()(),r(7,"ion-row")(8,"ion-col")(9,"ion-input",2),h("ngModelChange",function(s){return y(i.newTask.description,s)||(i.newTask.description=s),s}),n()()(),r(10,"ion-row")(11,"ion-col")(12,"ion-label"),l(13,"Score de la t\xE2che"),n()()(),r(14,"ion-row")(15,"ion-col")(16,"ion-input",3),h("ngModelChange",function(s){return y(i.newTask.score,s)||(i.newTask.score=s),s}),n()()(),r(17,"ion-row")(18,"ion-col")(19,"ion-label"),l(20,"Cat\xE9gories"),n()()(),r(21,"ion-row"),b(22,ie,8,2,"ion-col",4,te),n(),r(24,"ion-row")(25,"ion-col")(26,"ion-button"),l(27,"Cr\xE9er la t\xE2che"),n()()()()()()),t&2&&(c(9),f("ngModel",i.newTask.description),c(7),f("ngModel",i.newTask.score),c(6),v(i.categories))},dependencies:[x,D,M,F,P,j,G,z,N,B,q,A,U,O,R,W,L],styles:["ion-content[_ngcontent-%COMP%]{--background: #fcf8ed}ion-card-content.catCard[_ngcontent-%COMP%]{font-size:.85rem;font-weight:400;font-family:Roboto,sans-serif;width:150px;height:150px;display:flex;justify-content:center;align-items:center;text-align:center}ion-card[_ngcontent-%COMP%]{width:150px;height:150px;display:flex;border-radius:20px;--background: #2a9d8f}ion-list.catCardList[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:#2a9d8f}ion-img.catIcon[_ngcontent-%COMP%]{width:70px;height:70px;margin-bottom:12px}ion-text.catTitle[_ngcontent-%COMP%]{color:#fcf8ed}"]})};export{Z as CustomTaskCreationComponent};
