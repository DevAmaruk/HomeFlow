import{a as I}from"./chunk-QFI5ZUMR.js";import{A as L,r as G,v as T}from"./chunk-JEBJIWP7.js";import{A as _,C as b,G as z,e as h,i as N,j as C,n as O,o as y,p as j,u as D,y as A,z as R}from"./chunk-EXD6PV5Y.js";import{P as d,Q as a,S as f,Wa as M,_ as u,ca as i,da as n,ea as g,eb as x,ja as p,jb as c,lb as V,mb as F,nb as E,ob as v,sb as U,ta as o,tb as P,yb as k}from"./chunk-TPGHJTJC.js";import"./chunk-SRKNPOHE.js";import"./chunk-7KGURMOZ.js";import"./chunk-BLW5R4XS.js";import"./chunk-XPWJSSAW.js";import"./chunk-WNRD3PDI.js";import"./chunk-QQJWOYZO.js";import"./chunk-MHO3CSUV.js";import"./chunk-4WFVMWDK.js";import"./chunk-XDPEVTHG.js";import"./chunk-NMYJD6OP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-7D2EH4XU.js";import"./chunk-MMIXVVWR.js";import"./chunk-SV7S5NYR.js";import{g as m}from"./chunk-PM2M367S.js";function H(){return l=>{let e=l.value;if(!e)return null;let t=/[a-zA-Z]/.test(e),r=/\d/.test(e),s=/[!@#$%^&*(),.?":{}|<>]/.test(e);return t&&r&&s?null:{passwordStrength:!0}}}var S=class l{constructor(e,t){this._modalCtrl=e;this._authService=t}resendVerificationEmail(){return m(this,null,function*(){try{yield this._authService.resendVerificationEmail(),console.log("Verification email resent.")}catch(e){console.error("Error resending verification email:",e)}})}closeModal(){this._modalCtrl.dismiss()}static \u0275fac=function(t){return new(t||l)(a(b),a(I))};static \u0275cmp=f({type:l,selectors:[["app-email-verification-modal"]],decls:11,vars:0,consts:[[1,"ion-padding"],["expand","block",3,"click"],["expand","block","color","primary",3,"click"]],template:function(t,r){t&1&&(i(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),o(3,"V\xE9rifier votre email"),n()()(),i(4,"ion-content",0)(5,"p"),o(6,"Nous avons envoy\xE9 un email de v\xE9rification, veuillez suivre les instructions avant de poursuivre. Merci !"),n(),i(7,"ion-button",1),p("click",function(){return r.resendVerificationEmail()}),o(8,"Renvoyer l'email de v\xE9rification"),n(),i(9,"ion-button",2),p("click",function(){return r.closeModal()}),o(10,"Fermer"),n()())},dependencies:[y,_,R,C,h],encapsulation:2})};var q=class l{constructor(e,t,r,s){this._authService=e;this._route=t;this._firestore=r;this._modalCtrl=s}signUpForm=new E({});user;ngOnInit(){return m(this,null,function*(){this.createSignUpForm()})}createSignUpForm(){this.signUpForm=new E({email:new v("",c.compose([c.required,c.email])),password:new v("",c.compose([c.required,c.min(6),H()])),username:new v("")})}onSignUp(){return m(this,null,function*(){try{let{email:e,password:t,username:r}=this.signUpForm.value;if(this.user=yield this._authService.signUp(e,t),!this.user)throw new Error("User is null or undefined after sign up.");yield this._authService.updateUserProfile({displayName:r});let s=T(this._firestore,"Users",this.user.uid);yield L(s,{email:this.user.email,uid:this.user.uid,username:r,createdAt:new Date}),this.signUpForm.reset();let w=yield this._modalCtrl.create({component:S});w.onDidDismiss().then(()=>m(this,null,function*(){(yield this._authService.isEmailVerified())?(console.log("Email verified. Navigating to family page."),this._route.navigate(["/familly"])):console.log("Email not verified. Staying on the current page.")})),yield w.present(),console.log("User signed up successfully:",this.user.email)}catch(e){console.error("Error signing up:",e)}})}static \u0275fac=function(t){return new(t||l)(a(I),a(x),a(G),a(b))};static \u0275cmp=f({type:l,selectors:[["app-login"]],decls:41,vars:4,consts:[[1,"topContainer","ion-padding"],[1,"loginHomepageGrid","ion-no-padding"],[1,"ion-justify-content-center","ion-align-items-center"],["sizeLg","5"],["src","./Illustrations/Clouds/sky_clouds.webp"],[1,"emailInputContainer","ion-padding",3,"formGroup"],["fill","outline","shape","round","type","email","id","signUpEmail","labelPlacement","floating","formControlName","email",1,"input","ion-padding",3,"clearInput"],["slot","label"],["color","danger"],["fill","outline","shape","round","type","password","id","signUpPassword","labelPlacement","floating","formControlName","password",1,"input","ion-padding",3,"clearInput"],["fill","outline","shape","round","type","username","id","signUpUsername","labelPlacement","floating","formControlName","username",1,"input","ion-padding",3,"clearInput"],["size","auto",1,"ion-text-center"],["expand","block",3,"click"],[1,"bottomContainer","ion-padding"],[1,"illustrationHouseGrid","ion-no-padding"],[1,"ion-justify-content-center","ion-align-items-center","illustrationRow"],["sizeXs","9","sizeSm","5","sizeMd","5","sizeLg","5","sizeXl","5",1,"illustrationCol"],["src","./Illustrations/House/house.webp","alt","house_illustration",1,"houseIllustration"]],template:function(t,r){t&1&&(i(0,"ion-header"),g(1,"ion-toolbar"),n(),i(2,"ion-content")(3,"div")(4,"div",0)(5,"ion-grid",1)(6,"ion-row",2)(7,"ion-col",3),g(8,"ion-img",4),n()()()(),i(9,"div",5)(10,"ion-grid")(11,"ion-row",2)(12,"ion-col",3)(13,"ion-input",6)(14,"div",7),o(15,"Email "),i(16,"ion-text",8),o(17,"(Requis)"),n()()()()(),i(18,"ion-row",2)(19,"ion-col",3)(20,"ion-input",9)(21,"div",7),o(22,"Mot de passe "),i(23,"ion-text",8),o(24,"(Requis)"),n()()()()(),i(25,"ion-row")(26,"ion-col",3)(27,"ion-input",10)(28,"div",7),o(29,"Username"),i(30,"ion-text",8),o(31,"(Requis)"),n()()()()(),i(32,"ion-row",2)(33,"ion-col",11)(34,"ion-button",12),p("click",function(){return r.onSignUp()}),o(35,"Cr\xE9er un compte"),n()()()()(),i(36,"div",13)(37,"ion-grid",14)(38,"ion-row",15)(39,"ion-col",16),g(40,"ion-img",17),n()()()()()()),t&2&&(d(9),u("formGroup",r.signUpForm),d(4),u("clearInput",!0),d(7),u("clearInput",!0),d(7),u("clearInput",!0))},dependencies:[M,C,O,D,N,j,h,z,A,y,_,k,V,F,U,P],styles:["ion-content[_ngcontent-%COMP%]{--background: #fcf8ed}ion-grid.illustrationHouseGrid[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-end}ion-col.illustrationCol[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}ion-img.houseIllustration[_ngcontent-%COMP%]{width:auto;height:auto}ion-input.input-fill-outline.input-shape-round[_ngcontent-%COMP%]{--border-radius: 10px}ion-input.input[_ngcontent-%COMP%]{--background: #ffffff}ion-button[_ngcontent-%COMP%]{--background: #264653;--color: #fcf8ed;--border-radius: 12px;width:182px;height:58.9px;font-size:.8rem}div.topContainer[_ngcontent-%COMP%]{display:flex;justify-content:center;height:33vh}div.emailInputContainer[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:33vh}div.bottomContainer[_ngcontent-%COMP%]{display:flex;height:33vh}"]})};export{q as LoginComponent};
