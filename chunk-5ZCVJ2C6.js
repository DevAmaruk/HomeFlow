import{a as w}from"./chunk-WJDDQXF5.js";import{A as L,r as G,v as T}from"./chunk-JOGVLLNH.js";import{Ba as V,Bb as A,G as d,H as a,Ha as F,I as f,Ka as c,La as U,Ma as P,N as u,Na as E,Oa as g,R as i,Ra as O,S as o,Sa as k,T as x,Ua as z,W as p,Za as h,bb as v,cb as C,ea as n,hb as y,ib as j,jb as N,ob as _,sb as I,tb as D,vb as R,xb as b}from"./chunk-SPIVRC24.js";import"./chunk-SRKNPOHE.js";import"./chunk-7KGURMOZ.js";import"./chunk-BLW5R4XS.js";import"./chunk-XPWJSSAW.js";import"./chunk-WNRD3PDI.js";import"./chunk-QQJWOYZO.js";import"./chunk-MHO3CSUV.js";import"./chunk-4WFVMWDK.js";import"./chunk-XDPEVTHG.js";import"./chunk-NMYJD6OP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-7D2EH4XU.js";import"./chunk-MMIXVVWR.js";import"./chunk-SV7S5NYR.js";import{g as m}from"./chunk-PM2M367S.js";function q(){return l=>{let e=l.value;if(!e)return null;let t=/[a-zA-Z]/.test(e),r=/\d/.test(e),s=/[!@#$%^&*(),.?":{}|<>]/.test(e);return t&&r&&s?null:{passwordStrength:!0}}}var S=class l{constructor(e,t){this._modalCtrl=e;this._authService=t}resendVerificationEmail(){return m(this,null,function*(){try{yield this._authService.resendVerificationEmail(),console.log("Verification email resent.")}catch(e){console.error("Error resending verification email:",e)}})}closeModal(){this._modalCtrl.dismiss()}static \u0275fac=function(t){return new(t||l)(a(b),a(w))};static \u0275cmp=f({type:l,selectors:[["app-email-verification-modal"]],decls:18,vars:0,consts:[[1,"ion-padding"],[1,"ion-justify-content-center","ion-align-items-center"],["sizeXs","12","sizeSm","8","sizeMd","6","sizeLg","4"],["expand","block",3,"click"]],template:function(t,r){t&1&&(i(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),n(3,"V\xE9rifier votre email"),o()()(),i(4,"ion-content",0)(5,"ion-grid")(6,"ion-row",1)(7,"ion-col")(8,"ion-text"),n(9,"Nous avons envoy\xE9 un email de v\xE9rification, veuillez suivre les instructions avant de poursuivre. Merci ! "),o()()(),i(10,"ion-row",1)(11,"ion-col",2)(12,"ion-button",3),p("click",function(){return r.resendVerificationEmail()}),n(13," Renvoyer l'email de v\xE9rification "),o()()(),i(14,"ion-row",1)(15,"ion-col",2)(16,"ion-button",3),p("click",function(){return r.closeModal()}),n(17,"Fermer"),o()()()()())},dependencies:[j,R,D,C,h,y,_,v,I],styles:["ion-content[_ngcontent-%COMP%]{--background: #fcf8ed}ion-button[_ngcontent-%COMP%]{--background: #264653;--color: #fcf8ed;--border-radius: 12px;width:182px;height:58.9px;font-size:.8rem}ion-col[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}"]})};var H=class l{constructor(e,t,r,s){this._authService=e;this._route=t;this._firestore=r;this._modalCtrl=s}signUpForm=new E({});user;ngOnInit(){return m(this,null,function*(){this.createSignUpForm()})}createSignUpForm(){this.signUpForm=new E({email:new g("",c.compose([c.required,c.email])),password:new g("",c.compose([c.required,c.min(6),q()])),username:new g("")})}onSignUp(){return m(this,null,function*(){try{let{email:e,password:t,username:r}=this.signUpForm.value;if(this.user=yield this._authService.signUp(e,t),!this.user)throw new Error("User is null or undefined after sign up.");yield this._authService.updateUserProfile({displayName:r});let s=T(this._firestore,"Users",this.user.uid);yield L(s,{email:this.user.email,uid:this.user.uid,username:r,createdAt:new Date}),this.signUpForm.reset();let M=yield this._modalCtrl.create({component:S});M.onDidDismiss().then(()=>m(this,null,function*(){(yield this._authService.isEmailVerified())?(console.log("Email verified. Navigating to family page."),this._route.navigate(["/familly"])):console.log("Email not verified. Staying on the current page.")})),yield M.present(),console.log("User signed up successfully:",this.user.email)}catch(e){console.error("Error signing up:",e)}})}static \u0275fac=function(t){return new(t||l)(a(w),a(F),a(G),a(b))};static \u0275cmp=f({type:l,selectors:[["app-login"]],decls:39,vars:4,consts:[[1,"topContainer","ion-padding"],[1,"loginHomepageGrid","ion-no-padding"],[1,"ion-justify-content-center","ion-align-items-center"],["sizeLg","5"],["src","./Illustrations/Clouds/sky_clouds.webp"],[1,"emailInputContainer","ion-padding",3,"formGroup"],["fill","outline","shape","round","type","email","id","signUpEmail","labelPlacement","floating","formControlName","email",1,"input","ion-padding",3,"clearInput"],["slot","label"],["color","danger"],["fill","outline","shape","round","type","password","id","signUpPassword","labelPlacement","floating","formControlName","password",1,"input","ion-padding",3,"clearInput"],["fill","outline","shape","round","type","username","id","signUpUsername","labelPlacement","floating","formControlName","username",1,"input","ion-padding",3,"clearInput"],["size","auto",1,"ion-text-center"],["expand","block",3,"click"],[1,"bottomContainer","ion-padding"],[1,"illustrationHouseGrid","ion-no-padding"],[1,"ion-justify-content-center","ion-align-items-center","illustrationRow"],["sizeXs","9","sizeSm","5","sizeMd","5","sizeLg","5","sizeXl","5",1,"illustrationCol"],["src","./Illustrations/House/house.webp","alt","house_illustration",1,"houseIllustration"]],template:function(t,r){t&1&&(i(0,"ion-content")(1,"div")(2,"div",0)(3,"ion-grid",1)(4,"ion-row",2)(5,"ion-col",3),x(6,"ion-img",4),o()()()(),i(7,"div",5)(8,"ion-grid")(9,"ion-row",2)(10,"ion-col",3)(11,"ion-input",6)(12,"div",7),n(13,"Email "),i(14,"ion-text",8),n(15,"(Requis)"),o()()()()(),i(16,"ion-row",2)(17,"ion-col",3)(18,"ion-input",9)(19,"div",7),n(20,"Mot de passe "),i(21,"ion-text",8),n(22,"(Requis)"),o()()()()(),i(23,"ion-row")(24,"ion-col",3)(25,"ion-input",10)(26,"div",7),n(27,"Username"),i(28,"ion-text",8),n(29,"(Requis)"),o()()()()(),i(30,"ion-row",2)(31,"ion-col",11)(32,"ion-button",12),p("click",function(){return r.onSignUp()}),n(33,"Cr\xE9er un compte"),o()()()()(),i(34,"div",13)(35,"ion-grid",14)(36,"ion-row",15)(37,"ion-col",16),x(38,"ion-img",17),o()()()()()()),t&2&&(d(7),u("formGroup",r.signUpForm),d(4),u("clearInput",!0),d(7),u("clearInput",!0),d(7),u("clearInput",!0))},dependencies:[V,C,y,_,v,N,h,A,I,z,U,P,O,k],styles:["ion-content[_ngcontent-%COMP%]{--background: #fcf8ed}ion-grid.illustrationHouseGrid[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-end}ion-col.illustrationCol[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}ion-img.houseIllustration[_ngcontent-%COMP%]{width:auto;height:auto}ion-input.input-fill-outline.input-shape-round[_ngcontent-%COMP%]{--border-radius: 10px}ion-input.input[_ngcontent-%COMP%]{--background: #ffffff}ion-button[_ngcontent-%COMP%]{--background: #264653;--color: #fcf8ed;--border-radius: 12px;width:182px;height:58.9px;font-size:.8rem}div.topContainer[_ngcontent-%COMP%]{display:flex;justify-content:center;height:33vh}div.emailInputContainer[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:33vh}div.bottomContainer[_ngcontent-%COMP%]{display:flex;height:33vh}"]})};export{H as LoginComponent};
